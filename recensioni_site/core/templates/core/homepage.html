{% extends 'base.html' %}

{% block content %}
{% if request.user.is_authenticated %}
{% if listaSezioneTagFinaleSeria %}
<div class="container-fluid">
	<h1 class="text-center mb-3 text-white">Località consigliate per te</h1>
	<div id="myCarousel" class="carousel slide" data-ride="carousel">
		<div class="carousel-inner row w-100 mx-auto">
			{% for sezione in listaSezioneTagFinaleSeria %}
			<div class="carousel-item col-md-4 active">
				<div class="card">
					<img class="card-img-top" src="{{ sezione.logo_sezione.url }}" alt="Card image cap">
					<div class="card-body">
						<h4 class="card-title"><a style="color: #17a2b8;"
								href="{{ sezione.get_absolute_url}}"><strong>{{ sezione.nome_sezione }}</strong></a>
						</h4>
						<p class="card-text">{{sezione.indirizzo}} - {{sezione.citta}} - {{sezione.provincia}}</p>
						{% if sezione.hotelB %}
						<h5 style="color: #17a2b8;">hotel</h5>
						{% endif %}
						
						{% if sezione.ristoranteB %}
						<h5 style="color: #17a2b8;">ristorante</h5>
						{% endif %}
						
						{% if sezione.fastFoodB %}
						<h5 style="color: #17a2b8;">fastFood</h5>
						{% endif %}
						
						{% if sezione.casaVacanzaB %}
						<h5 style="color: #17a2b8;">casaVacanza</h5>
						{% endif %}
						
						{% if sezione.agriturismoB %}
						<h5 style="color: #17a2b8;">agriturismo</h5>
						{% endif %}
						
						<h5>{{ sezione.tipo }}</h5>
						<p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
					</div>
				</div>
			</div>
			{% endfor %}
		</div>
		<a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="sr-only">Previous</span>
		</a>
		<a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="sr-only">Next</span>
		</a>
	</div>
</div>
<br>
<br>
{% endif %}
{% endif %}
{% if not request.user.is_authenticated %}
<div class="container-fluid">
	<h1 class="text-center mb-3 text-white">Località più votate</h1>
	<div id="myCarousel" class="carousel slide" data-ride="carousel">
		<div class="carousel-inner row w-100 mx-auto">
			{% for sezione in sezioniOrderRating %}
			<div class="carousel-item col-md-4 active">
				<div class="card">
					<img class="card-img-top" src="{{ sezione.logo_sezione.url }}"
						alt="Card image cap">
					<div class="card-body">
						<h4 class="card-title"><a style="color: #17a2b8;" href="{{ sezione.get_absolute_url}}"><strong>{{ sezione.nome_sezione }}</strong></a></h4>
						<p class="card-text">{{sezione.indirizzo}} - {{sezione.citta}} - {{sezione.provincia}}</p>
						{% if sezione.hotelB %}
						<h5 style="color: #17a2b8;">hotel</h5>
						{% endif %}
						
						{% if sezione.ristoranteB %}
						<h5 style="color: #17a2b8;">ristorante</h5>
						{% endif %}
						
						{% if sezione.fastFoodB %}
						<h5 style="color: #17a2b8;">fastFood</h5>
						{% endif %}
						
						{% if sezione.casaVacanzaB %}
						<h5 style="color: #17a2b8;">casaVacanza</h5>
						{% endif %}
						
						{% if sezione.agriturismoB %}
						<h5 style="color: #17a2b8;">agriturismo</h5>
						{% endif %}
						
						<h5>{{ sezione.tipo }}</h5>
						<p class="card-text"><small class="text-muted">Rating: {{sezione.mediaRating}}</small></p>
						<p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
					</div>
				</div>
			</div>
			{% endfor %}
		</div>
		<a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="sr-only">Previous</span>
		</a>
		<a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="sr-only">Next</span>
		</a>
	</div>
</div>
<br>
<br>
{% endif %}
<div class="container">
<h1 class="text-white">Tutte le località</h1>

    {% for sezione in lista_sezioni %}
    <div class="courses-container">
        <div class="course">
            <div class="course-preview">
                <img src="{{ sezione.logo_sezione.url }}" style="margin-left: auto; margin-right: auto; width: 100%; " alt="logo della sezione">
            </div>
            <div class="course-info">

                <h6>{{sezione.indirizzo}} - {{sezione.citta}} - {{sezione.provincia}}<h6 class="float-right"> Rating: {{sezione.mediaRating}}</h6>  </h6>
                <h2><a style="color: #17a2b8;"
                        href="{{ sezione.get_absolute_url}}"><strong>{{ sezione.nome_sezione }}</strong></a></h2>
                <h3>{{ sezione.descrizione }}</h3>

                {% if sezione.hotelB %}
                    <h5 style="color: #17a2b8;">hotel</h5>
                {% endif %}

                {% if sezione.ristoranteB %}
                    <h5 style="color: #17a2b8;">ristorante</h5>
                {% endif %}

                {% if sezione.fastFoodB %}
                    <h5 style="color: #17a2b8;">fastFood</h5>
                {% endif %}

                {% if sezione.casaVacanzaB %}
                    <h5 style="color: #17a2b8;">casaVacanza</h5>
                {% endif %}

                {% if sezione.agriturismoB %}
                    <h5 style="color: #17a2b8;">agriturismo</h5>
                {% endif %}

                <h5>{{ sezione.tipo }}</h5>

                <button onclick="location.href='{{ sezione.get_absolute_url}}'" class="btn1">Apri</button>
            </div>
        </div>
    </div>
    {% endfor %}

</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
	$(document).ready(function () {
			$("#myCarousel").on("slide.bs.carousel", function (e) {
				var $e = $(e.relatedTarget);
				var idx = $e.index();
				var itemsPerSlide = 3;
				var totalItems = $(".carousel-item").length;

				if (idx >= totalItems - (itemsPerSlide - 1)) {
					var it = itemsPerSlide - (totalItems - idx);
					for (var i = 0; i < it; i++) {
						// append slides to end
						if (e.direction == "left") {
							$(".carousel-item")
								.eq(i)
								.appendTo(".carousel-inner");
						} else {
							$(".carousel-item")
								.eq(0)
								.appendTo($(this).find(".carousel-inner"));
						}
					}
				}
			});
			

			$(".carousel-item").removeClass("active")
			$('.carousel-item:first').addClass('active');
		});
</script>


<style>
	img{
		height:20rem
	}
    @import url('https://fonts.googleapis.com/css?family=Muli&display=swap');

* {
	box-sizing: border-box;
}

@media (min-width: 768px) {
	.carousel-item {
  position: relative;
  display: none;
  float: left;
  width: 100%;
  margin-right: 0% !important;
  backface-visibility: hidden;
  @include transition($carousel-transition);
}
  /* show 3 items */
  .carousel-inner .active,
  .carousel-inner .active + .carousel-item,
  .carousel-inner .active + .carousel-item + .carousel-item {
    display: block;
  }

  .carousel-inner .carousel-item.active:not(.carousel-item-right):not(.carousel-item-left),
  .carousel-inner .carousel-item.active:not(.carousel-item-right):not(.carousel-item-left) + .carousel-item,
  .carousel-inner .carousel-item.active:not(.carousel-item-right):not(.carousel-item-left) + .carousel-item + .carousel-item {
    transition: none;
  }

  .carousel-inner .carousel-item-next,
  .carousel-inner .carousel-item-prev {
    position: relative;
    transform: translate3d(0, 0, 0);
  }

  .carousel-inner .active.carousel-item + .carousel-item + .carousel-item + .carousel-item {
    position: absolute;
    top: 0;
    right: -33.3333%;
    z-index: -1;
    display: block;
    visibility: visible;
  }

  /* left or forward direction */
  .active.carousel-item-left + .carousel-item-next.carousel-item-left,
  .carousel-item-next.carousel-item-left + .carousel-item,
  .carousel-item-next.carousel-item-left + .carousel-item + .carousel-item,
  .carousel-item-next.carousel-item-left + .carousel-item + .carousel-item + .carousel-item {
    position: relative;
    transform: translate3d(-100%, 0, 0);
    visibility: visible;
  }

  /* farthest right hidden item must be abso position for animations */
  .carousel-inner .carousel-item-prev.carousel-item-right {
    position: absolute;
    top: 0;
    left: 0;
    z-index: -1;
    display: block;
    visibility: visible;
  }

  /* right or prev direction */
  .active.carousel-item-right + .carousel-item-prev.carousel-item-right,
  .carousel-item-prev.carousel-item-right + .carousel-item,
  .carousel-item-prev.carousel-item-right + .carousel-item + .carousel-item,
  .carousel-item-prev.carousel-item-right + .carousel-item + .carousel-item + .carousel-item {
    position: relative;
    transform: translate3d(100%, 0, 0);
    visibility: visible;
    display: block;
    visibility: visible;
  }
}

.course {
	background-color: #fff;
	border-radius: 10px;
	box-shadow: 0 10px 10px rgba(0, 0, 0, 0.2);
	display: flex;
	max-width: 100%;
	margin: 20px;
	overflow: hidden;
}

.course h6 {
	opacity: 0.6;
	margin: 0;
	letter-spacing: 1px;
	text-transform: uppercase;
}

.course h2 {
	letter-spacing: 1px;
	margin: 10px 0;
}

.course-preview {
	background-color: #054049!important;
	color: #fff;
	padding: 10px;
	max-width: 300px;
}

.course-preview a {
	color: #fff;
	display: inline-block;
	font-size: 12px;
	opacity: 0.6;
	margin-top: 30px;
	text-decoration: none;
}

.course-info {
	padding: 30px;
	position: relative;
	width: 100%;
}

.progress-container {
	position: absolute;
	top: 30px;
	right: 30px;
	text-align: right;
	width: 150px;
}

.progress {
	background-color: #ddd;
	border-radius: 3px;
	height: 5px;
	width: 100%;
}

.progress::after {
	border-radius: 3px;
	background-color: #17a2b8;
	content: '';
	position: absolute;
	top: 0;
	left: 0;
	height: 5px;
	width: 66%;
}

.progress-text {
	font-size: 10px;
	opacity: 0.6;
	letter-spacing: 1px;
}

.btn1 {
	background-color: #17a2b8;
	border: 0;
	border-radius: 50px;
	box-shadow: 0 10px 10px rgba(0, 0, 0, 0.2);
	color: #fff;
	font-size: 16px;
	padding: 12px 25px;
	position: absolute;
	bottom: 30px;
	right: 30px;
	letter-spacing: 1px;
}

/* SOCIAL PANEL CSS */
.social-panel-container {
	position: fixed;
	right: 0;
	bottom: 80px;
	transform: translateX(100%);
	transition: transform 0.4s ease-in-out;
}

.social-panel-container.visible {
	transform: translateX(-10px);
}

.social-panel {	
	background-color: #fff;
	border-radius: 16px;
	box-shadow: 0 16px 31px -17px rgba(0,31,97,0.6);
	border: 5px solid #17a2b8;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	font-family: 'Muli';
	position: relative;
	height: 169px;	
	width: 370px;
	max-width: calc(100% - 10px);
}

.social-panel button.close-btn {
	border: 0;
	color: #97A5CE;
	cursor: pointer;
	font-size: 20px;
	position: absolute;
	top: 5px;
	right: 5px;
}

.social-panel button.close-btn:focus {
	outline: none;
}

.social-panel p {
	background-color: #17a2b8;
	border-radius: 0 0 10px 10px;
	color: #fff;
	font-size: 14px;
	line-height: 18px;
	padding: 2px 17px 6px;
	position: absolute;
	top: 0;
	left: 50%;
	margin: 0;
	transform: translateX(-50%);
	text-align: center;
	width: 235px;
}

.social-panel p i {
	margin: 0 5px;
}

.social-panel p a {
	color: #FF7500;
	text-decoration: none;
}

.social-panel h4 {
	margin: 20px 0;
	color: #97A5CE;	
	font-family: 'Muli';	
	font-size: 14px;	
	line-height: 18px;
	text-transform: uppercase;
}

.social-panel ul {
	display: flex;
	list-style-type: none;
	padding: 0;
	margin: 0;
}

.social-panel ul li {
	margin: 0 10px;
}

.social-panel ul li a {
	border: 1px solid #DCE1F2;
	border-radius: 50%;
	color: #001F61;
	font-size: 20px;
	display: flex;
	justify-content: center;
	align-items: center;
	height: 50px;
	width: 50px;
	text-decoration: none;
}

.social-panel ul li a:hover {
	border-color: #FF6A00;
	box-shadow: 0 9px 12px -9px #FF6A00;
}

.floating-btn {
	border-radius: 26.5px;
	background-color: #001F61;
	border: 1px solid #001F61;
	box-shadow: 0 16px 22px -17px #03153B;
	color: #fff;
	cursor: pointer;
	font-size: 16px;
	line-height: 20px;
	padding: 12px 20px;
	position: fixed;
	bottom: 20px;
	right: 20px;
	z-index: 999;
}

.floating-btn:hover {
	background-color: #ffffff;
	color: #001F61;
}

.floating-btn:focus {
	outline: none;
}

.floating-text {
	background-color: #001F61;
	border-radius: 10px 10px 0 0;
	color: #fff;
	font-family: 'Muli';
	padding: 7px 15px;
	position: fixed;
	bottom: 0;
	left: 50%;
	transform: translateX(-50%);
	text-align: center;
	z-index: 998;
}

.floating-text a {
	color: #FF7500;
	text-decoration: none;
}

@media screen and (max-width: 480px) {

	.social-panel-container.visible {
		transform: translateX(0px);
	}
	
	.floating-btn {
		right: 10px;
	}
}
</style>

{% endblock content %}